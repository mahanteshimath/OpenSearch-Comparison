<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenSearch for RAG: Serverless vs Managed Clusters</title>
    <style>
        :root {
            --primary: #1a73e8;
            --primary-dark: #1557b0;
            --bg: #f8f9fa;
            --card-bg: #ffffff;
            --text: #202124;
            --text-light: #5f6368;
            --border: #dadce0;
            --green: #0d904f;
            --orange: #e37400;
            --red: #d93025;
            --blue-light: #e8f0fe;
            --green-light: #e6f4ea;
            --orange-light: #fef7e0;
            --red-light: #fce8e6;
            --purple: #7b1fa2;
            --purple-light: #f3e8fd;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', system-ui, -apple-system, sans-serif; background: var(--bg); color: var(--text); line-height: 1.6; }
        
        /* Hero Section */
        .hero {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: white; padding: 60px 20px; text-align: center;
        }
        .hero h1 { font-size: 2.5em; margin-bottom: 10px; font-weight: 700; }
        .hero p { font-size: 1.2em; opacity: 0.85; max-width: 700px; margin: 0 auto; }
        .hero .badge { display: inline-block; background: rgba(255,255,255,0.15); padding: 6px 16px; border-radius: 20px; font-size: 0.85em; margin-top: 15px; }
        
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        
        /* Navigation Tabs */
        .tab-nav {
            display: flex; gap: 0; background: var(--card-bg); border-radius: 12px;
            margin: -30px auto 30px; max-width: 900px; overflow: hidden;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1); position: relative; z-index: 10;
        }
        .tab-btn {
            flex: 1; padding: 16px 10px; border: none; background: transparent;
            cursor: pointer; font-size: 0.95em; font-weight: 600; color: var(--text-light);
            transition: all 0.3s; border-bottom: 3px solid transparent;
        }
        .tab-btn.active { color: var(--primary); border-bottom-color: var(--primary); background: var(--blue-light); }
        .tab-btn:hover:not(.active) { background: #f1f3f4; }
        
        .tab-content { display: none; animation: fadeIn 0.4s; }
        .tab-content.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        /* Cards */
        .card {
            background: var(--card-bg); border-radius: 12px; padding: 28px;
            margin-bottom: 24px; box-shadow: 0 1px 6px rgba(0,0,0,0.08);
            border: 1px solid var(--border);
        }
        .card h2 { font-size: 1.4em; margin-bottom: 16px; display: flex; align-items: center; gap: 10px; }
        .card h3 { font-size: 1.1em; margin: 18px 0 10px; color: var(--text); }
        
        /* Comparison Grid */
        .compare-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; }
        @media (max-width: 768px) { .compare-grid { grid-template-columns: 1fr; } }
        
        .compare-card {
            border-radius: 12px; padding: 24px; border: 2px solid;
        }
        .compare-card.serverless { border-color: var(--primary); background: linear-gradient(to bottom, var(--blue-light), var(--card-bg)); }
        .compare-card.managed { border-color: var(--green); background: linear-gradient(to bottom, var(--green-light), var(--card-bg)); }
        .compare-card h3 { margin-top: 0; font-size: 1.3em; }
        .compare-card .subtitle { font-size: 0.9em; color: var(--text-light); margin-bottom: 14px; }
        .compare-card ul { list-style: none; padding: 0; }
        .compare-card li { padding: 8px 0; border-bottom: 1px solid #eee; font-size: 0.95em; }
        .compare-card li:last-child { border: none; }
        .compare-card li::before { content: "‚úì "; color: inherit; font-weight: bold; }
        .compare-card.serverless li::before { color: var(--primary); }
        .compare-card.managed li::before { color: var(--green); }
        
        /* Table */
        .table-wrapper { overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; font-size: 0.92em; }
        th { background: #f1f3f4; padding: 12px 16px; text-align: left; font-weight: 600; border-bottom: 2px solid var(--border); }
        td { padding: 12px 16px; border-bottom: 1px solid #eee; }
        tr:hover td { background: #f8f9fa; }
        
        /* Cost Calculator */
        .calc-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; align-items: start; }
        @media (max-width: 768px) { .calc-grid { grid-template-columns: 1fr; } }
        .calc-input { margin-bottom: 16px; }
        .calc-input label { display: block; font-weight: 600; margin-bottom: 6px; font-size: 0.9em; }
        .calc-input input, .calc-input select {
            width: 100%; padding: 10px 14px; border: 1px solid var(--border);
            border-radius: 8px; font-size: 1em;
        }
        .calc-input input:focus, .calc-input select:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 3px rgba(26,115,232,0.15); }
        .calc-result {
            background: linear-gradient(135deg, #1a1a2e, #0f3460); color: white;
            border-radius: 12px; padding: 24px; text-align: center;
        }
        .calc-result h3 { margin-bottom: 20px; font-size: 1.1em; opacity: 0.9; }
        .cost-box { background: rgba(255,255,255,0.1); border-radius: 10px; padding: 16px; margin-bottom: 12px; }
        .cost-box .label { font-size: 0.85em; opacity: 0.8; }
        .cost-box .amount { font-size: 1.8em; font-weight: 700; }
        .cost-box.winner { border: 2px solid #4caf50; background: rgba(76,175,80,0.15); }
        .recommendation { margin-top: 16px; padding: 12px; background: rgba(255,255,255,0.1); border-radius: 8px; font-size: 0.9em; }
        
        /* Decision Tree */
        .decision-tree { max-width: 700px; margin: 0 auto; }
        .decision-node {
            background: var(--card-bg); border: 2px solid var(--primary); border-radius: 12px;
            padding: 20px; margin-bottom: 16px; cursor: pointer; transition: all 0.3s;
        }
        .decision-node:hover { box-shadow: 0 4px 15px rgba(26,115,232,0.2); transform: translateY(-2px); }
        .decision-node .question { font-weight: 700; font-size: 1.05em; margin-bottom: 8px; }
        .decision-node .options { display: none; margin-top: 12px; }
        .decision-node.open .options { display: block; }
        .option-btn {
            display: block; width: 100%; padding: 12px 16px; margin: 6px 0;
            border: 1px solid var(--border); border-radius: 8px; background: #f8f9fa;
            cursor: pointer; text-align: left; font-size: 0.95em; transition: all 0.2s;
        }
        .option-btn:hover { background: var(--blue-light); border-color: var(--primary); }
        .option-btn.selected { background: var(--primary); color: white; border-color: var(--primary); }
        
        .result-card {
            border-radius: 12px; padding: 24px; margin-top: 20px; display: none;
            animation: fadeIn 0.5s;
        }
        .result-card.serverless-result { background: var(--blue-light); border: 2px solid var(--primary); }
        .result-card.managed-result { background: var(--green-light); border: 2px solid var(--green); }
        .result-card h3 { margin-bottom: 8px; }
        
        /* Architecture Diagram */
        .arch-diagram {
            background: #1a1a2e; border-radius: 12px; padding: 30px; color: white;
            margin: 20px 0; overflow-x: auto;
        }
        .arch-row { display: flex; align-items: center; justify-content: center; gap: 16px; margin: 12px 0; flex-wrap: wrap; }
        .arch-box {
            padding: 12px 20px; border-radius: 8px; font-size: 0.85em; font-weight: 600;
            text-align: center; min-width: 130px;
        }
        .arch-box.user { background: #e91e63; }
        .arch-box.app { background: #9c27b0; }
        .arch-box.embed { background: #673ab7; }
        .arch-box.os { background: #1a73e8; }
        .arch-box.llm { background: #e37400; }
        .arch-box.s3 { background: #0d904f; }
        .arch-arrow { font-size: 1.4em; opacity: 0.6; }
        .arch-label { font-size: 0.75em; opacity: 0.7; text-align: center; display: block; margin-top: 4px; }
        
        /* Info boxes */
        .info-box { padding: 16px 20px; border-radius: 8px; margin: 16px 0; font-size: 0.95em; }
        .info-box.tip { background: var(--green-light); border-left: 4px solid var(--green); }
        .info-box.warn { background: var(--orange-light); border-left: 4px solid var(--orange); }
        .info-box.danger { background: var(--red-light); border-left: 4px solid var(--red); }
        .info-box.info { background: var(--blue-light); border-left: 4px solid var(--primary); }
        .info-box strong { display: block; margin-bottom: 4px; }
        
        /* Reference links */
        .ref-list { list-style: none; padding: 0; }
        .ref-list li { padding: 10px 14px; margin: 6px 0; background: #f8f9fa; border-radius: 8px; border-left: 3px solid var(--primary); }
        .ref-list a { color: var(--primary); text-decoration: none; font-weight: 500; }
        .ref-list a:hover { text-decoration: underline; }
        .ref-list .ref-desc { font-size: 0.85em; color: var(--text-light); margin-top: 2px; }
        
        /* Pill tags */
        .pill { display: inline-block; padding: 3px 10px; border-radius: 12px; font-size: 0.78em; font-weight: 600; margin: 2px; }
        .pill.blue { background: var(--blue-light); color: var(--primary); }
        .pill.green { background: var(--green-light); color: var(--green); }
        .pill.orange { background: var(--orange-light); color: var(--orange); }
        .pill.purple { background: var(--purple-light); color: var(--purple); }
        
        /* Footer */
        footer { text-align: center; padding: 30px; color: var(--text-light); font-size: 0.85em; border-top: 1px solid var(--border); margin-top: 40px; }
        footer a { color: var(--primary); }
    </style>
</head>
<body>
    <!-- Hero -->
    <div class="hero">
        <h1>üîç OpenSearch for RAG Pipelines</h1>
        <p>A comprehensive comparison of Amazon OpenSearch Serverless vs Managed Clusters for Retrieval-Augmented Generation</p>
        <span class="badge">üìÖ Updated February 2026</span>
    </div>

    <!-- Tab Navigation -->
    <div class="container">
        <div class="tab-nav">
            <button class="tab-btn active" onclick="showTab('overview')">Overview</button>
            <button class="tab-btn" onclick="showTab('comparison')">Comparison</button>
            <button class="tab-btn" onclick="showTab('cost')">Cost Calculator</button>
            <button class="tab-btn" onclick="showTab('decision')">Decision Guide</button>
            <button class="tab-btn" onclick="showTab('architecture')">Architecture</button>
            <button class="tab-btn" onclick="showTab('refs')">References</button>
        </div>

        <!-- TAB 1: Overview -->
        <div id="overview" class="tab-content active">
            <div class="card">
                <h2>üìñ What is RAG with OpenSearch?</h2>
                <p>Retrieval-Augmented Generation (RAG) grounds LLM responses in factual data by retrieving relevant documents from a vector database before generating answers. OpenSearch serves as the vector store ‚Äî it indexes document embeddings and performs fast similarity searches (k-NN) to find the most relevant context for each query.</p>
                <div class="info-box info">
                    <strong>How it works:</strong>
                    Documents ‚Üí Chunked ‚Üí Embedded (vectors) ‚Üí Stored in OpenSearch ‚Üí User query embedded ‚Üí k-NN search retrieves top-k chunks ‚Üí LLM generates grounded answer
                </div>
                <h3>OpenSearch RAG Features</h3>
                <ul style="margin-left:20px; margin-top:8px;">
                    <li><strong>k-NN Vector Search</strong> ‚Äî Supports HNSW algorithm via FAISS, NMSLIB, and Lucene engines for fast approximate nearest neighbor search</li>
                    <li><strong>Neural Search Plugin</strong> ‚Äî Auto-generates embeddings at ingest time using ML models</li>
                    <li><strong>RAG Search Pipeline Processor</strong> (v2.12+) ‚Äî Built-in processor that intercepts queries, retrieves context, and calls LLMs</li>
                    <li><strong>Hybrid Search</strong> ‚Äî Combines vector similarity with keyword/BM25 search for better relevance</li>
                    <li><strong>Amazon Bedrock Integration</strong> ‚Äî Native support as a Knowledge Base vector store</li>
                </ul>
            </div>

            <div class="compare-grid">
                <div class="compare-card serverless">
                    <h3>üöÄ OpenSearch Serverless</h3>
                    <p class="subtitle">Zero infrastructure management, auto-scaling collections</p>
                    <ul>
                        <li>No clusters or nodes to manage</li>
                        <li>Auto-scales with OCUs (OpenSearch Compute Units)</li>
                        <li>Separate indexing &amp; search compute</li>
                        <li>Storage decoupled (Amazon S3)</li>
                        <li>Vector, Search, and Time-series collection types</li>
                        <li>Encryption at rest required by default</li>
                        <li>Automatic version upgrades</li>
                        <li>Built-in multi-AZ redundancy</li>
                    </ul>
                </div>
                <div class="compare-card managed">
                    <h3>‚öôÔ∏è Managed OpenSearch Clusters</h3>
                    <p class="subtitle">Full control with pre-provisioned EC2 instances</p>
                    <ul>
                        <li>Choose instance types, node counts, storage</li>
                        <li>Full cluster configuration control</li>
                        <li>FAISS, NMSLIB, and Lucene vector engines</li>
                        <li>Fine-grained access control (FGAC)</li>
                        <li>UltraWarm &amp; Cold storage tiers</li>
                        <li>Custom sharding strategies</li>
                        <li>Manual version upgrades</li>
                        <li>Reserved Instance pricing available</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- TAB 2: Comparison -->
        <div id="comparison" class="tab-content">
            <div class="card">
                <h2>üìä Feature-by-Feature Comparison</h2>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Feature</th>
                                <th>Serverless</th>
                                <th>Managed Cluster</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Resource Unit</strong></td>
                                <td>Collections (logical index groups)</td>
                                <td>Domains (pre-provisioned clusters)</td>
                            </tr>
                            <tr>
                                <td><strong>Scaling</strong></td>
                                <td>Automatic (OCU-based)</td>
                                <td>Manual (add/change nodes)</td>
                            </tr>
                            <tr>
                                <td><strong>Vector Engines</strong></td>
                                <td>Lucene (for vector collections)</td>
                                <td>FAISS, NMSLIB, Lucene</td>
                            </tr>
                            <tr>
                                <td><strong>Billing Model</strong></td>
                                <td>OCU-hours + GB storage</td>
                                <td>Instance-hours + EBS storage</td>
                            </tr>
                            <tr>
                                <td><strong>Minimum Cost</strong></td>
                                <td>~$350/mo (dev) ¬∑ ~$700/mo (prod)</td>
                                <td>~$70-150/mo (small instances)</td>
                            </tr>
                            <tr>
                                <td><strong>Scale to Zero</strong></td>
                                <td>‚ùå No (always-on OCUs)</td>
                                <td>‚ùå No (always-on instances)</td>
                            </tr>
                            <tr>
                                <td><strong>Storage</strong></td>
                                <td>S3-backed (decoupled)</td>
                                <td>EBS volumes (coupled to nodes)</td>
                            </tr>
                            <tr>
                                <td><strong>Encryption</strong></td>
                                <td>Required (always on)</td>
                                <td>Optional (configurable)</td>
                            </tr>
                            <tr>
                                <td><strong>Version Upgrades</strong></td>
                                <td>Automatic</td>
                                <td>Manual</td>
                            </tr>
                            <tr>
                                <td><strong>Shard Management</strong></td>
                                <td>Automatic</td>
                                <td>Manual (full control)</td>
                            </tr>
                            <tr>
                                <td><strong>k-NN Tuning</strong></td>
                                <td>Limited</td>
                                <td>Full (ef_search, ef_construction, m)</td>
                            </tr>
                            <tr>
                                <td><strong>Bedrock KB Support</strong></td>
                                <td>‚úÖ Yes (default option)</td>
                                <td>‚úÖ Yes (added July 2025)</td>
                            </tr>
                            <tr>
                                <td><strong>Hybrid Search</strong></td>
                                <td>‚úÖ Yes</td>
                                <td>‚úÖ Yes</td>
                            </tr>
                            <tr>
                                <td><strong>Neural Search Plugin</strong></td>
                                <td>‚úÖ Yes</td>
                                <td>‚úÖ Yes</td>
                            </tr>
                            <tr>
                                <td><strong>VPC Support</strong></td>
                                <td>VPC endpoints via policies</td>
                                <td>Native VPC deployment</td>
                            </tr>
                            <tr>
                                <td><strong>Ops Overhead</strong></td>
                                <td>üü¢ Minimal</td>
                                <td>üî¥ Significant</td>
                            </tr>
                            <tr>
                                <td><strong>Best For RAG</strong></td>
                                <td>Quick start, variable traffic</td>
                                <td>Large-scale, cost-optimized prod</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="card">
                <h2>‚ö° RAG-Specific Differences</h2>
                <div class="compare-grid">
                    <div style="padding:0;">
                        <h3>Serverless for RAG</h3>
                        <div class="info-box tip">
                            <strong>‚úÖ Advantages</strong>
                            Zero ops ‚Äî focus on your RAG logic, not infrastructure. Auto-scales during embedding ingestion bursts. Default choice for Amazon Bedrock Knowledge Bases. Ideal for POCs and prototypes.
                        </div>
                        <div class="info-box warn">
                            <strong>‚ö†Ô∏è Limitations</strong>
                            Only Lucene engine for vectors (no FAISS/NMSLIB). Limited k-NN parameter tuning. Minimum ~$350/mo even idle. Cannot customize sharding for large vector indexes. Subset of OpenSearch APIs supported.
                        </div>
                    </div>
                    <div style="padding:0;">
                        <h3>Managed for RAG</h3>
                        <div class="info-box tip">
                            <strong>‚úÖ Advantages</strong>
                            Choose FAISS for better vector performance. Full k-NN tuning (ef_search, m, etc.). Lower entry cost for small workloads. Reserved Instances cut costs 30-50%. Custom memory/CPU allocation for vectors.
                        </div>
                        <div class="info-box warn">
                            <strong>‚ö†Ô∏è Limitations</strong>
                            Must size cluster correctly ‚Äî under-provisioned = slow queries. Manual scaling during ingestion spikes. Need expertise in shard management. Must manage upgrades and patches. More complex Bedrock KB setup.
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB 3: Cost Calculator -->
        <div id="cost" class="tab-content">
            <div class="card">
                <h2>üí∞ Cost Comparison Calculator</h2>
                <p style="margin-bottom:20px; color: var(--text-light);">Estimate monthly costs for both deployment options based on your workload. All prices in USD (us-east-1).</p>
                
                <div class="calc-grid">
                    <div>
                        <div class="calc-input">
                            <label>üì¶ Data Volume (GB)</label>
                            <input type="number" id="dataVol" value="50" min="1" oninput="calculate()">
                        </div>
                        <div class="calc-input">
                            <label>üî¢ Number of Vectors (millions)</label>
                            <input type="number" id="numVectors" value="5" min="0.1" step="0.1" oninput="calculate()">
                        </div>
                        <div class="calc-input">
                            <label>üìê Vector Dimensions</label>
                            <select id="dimensions" onchange="calculate()">
                                <option value="384">384 (MiniLM)</option>
                                <option value="768">768 (BERT-base)</option>
                                <option value="1024" selected>1024 (Cohere/Titan)</option>
                                <option value="1536">1536 (OpenAI ada-002)</option>
                                <option value="3072">3072 (OpenAI text-3-large)</option>
                            </select>
                        </div>
                        <div class="calc-input">
                            <label>üîç Queries per Day</label>
                            <input type="number" id="queriesDay" value="1000" min="0" oninput="calculate()">
                        </div>
                        <div class="calc-input">
                            <label>üìä Workload Pattern</label>
                            <select id="workload" onchange="calculate()">
                                <option value="steady">Steady (consistent traffic)</option>
                                <option value="variable" selected>Variable (spiky traffic)</option>
                                <option value="batch">Batch (periodic ingestion)</option>
                            </select>
                        </div>
                        <div class="calc-input">
                            <label>üèóÔ∏è Environment</label>
                            <select id="env" onchange="calculate()">
                                <option value="dev">Development / POC</option>
                                <option value="staging">Staging</option>
                                <option value="prod" selected>Production</option>
                            </select>
                        </div>
                    </div>
                    <div>
                        <div class="calc-result" id="calcResult">
                            <h3>Estimated Monthly Cost</h3>
                            <div class="cost-box" id="serverlessCost">
                                <div class="label">üöÄ OpenSearch Serverless</div>
                                <div class="amount" id="serverlessAmt">$700</div>
                                <div class="label" id="serverlessBreak">2 OCU index + 2 OCU search + storage</div>
                            </div>
                            <div class="cost-box" id="managedCost">
                                <div class="label">‚öôÔ∏è Managed Cluster</div>
                                <div class="amount" id="managedAmt">$320</div>
                                <div class="label" id="managedBreak">2x r6g.large + EBS storage</div>
                            </div>
                            <div class="recommendation" id="recommendation">
                                üí° For this workload, <strong>Managed Cluster</strong> is more cost-effective.
                            </div>
                        </div>
                        
                        <div class="info-box warn" style="margin-top:16px;">
                            <strong>‚ö†Ô∏è Cost Gotcha ‚Äî Serverless</strong>
                            Unlike AWS Lambda, OpenSearch Serverless charges continuously even when idle. Minimum ~$350/mo (dev) or ~$700/mo (prod with multi-AZ). You pay by the hour, not per request.
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <h2>üìã Pricing Breakdown Reference</h2>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr><th>Component</th><th>Serverless Price</th><th>Managed Equivalent</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>Compute (Indexing)</td><td>$0.24/OCU/hr (1 OCU = 6GB RAM)</td><td>Varies by instance (e.g., r6g.large $0.167/hr)</td></tr>
                            <tr><td>Compute (Search)</td><td>$0.24/OCU/hr</td><td>Same instances handle both</td></tr>
                            <tr><td>Storage</td><td>$0.024/GB/mo (S3-backed)</td><td>EBS gp3: $0.08/GB/mo</td></tr>
                            <tr><td>Minimum (Dev)</td><td>~$350/mo (0.5 OCU √ó 4)</td><td>~$75/mo (1√ó t3.small.search)</td></tr>
                            <tr><td>Minimum (Prod)</td><td>~$700/mo (1 OCU √ó 4)</td><td>~$300/mo (3√ó m5.large.search)</td></tr>
                            <tr><td>Reserved Instances</td><td>Not available</td><td>30-50% savings (1yr/3yr)</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- TAB 4: Decision Guide -->
        <div id="decision" class="tab-content">
            <div class="card">
                <h2>üß≠ Interactive Decision Guide</h2>
                <p style="margin-bottom:20px; color: var(--text-light);">Answer these questions to find the best OpenSearch option for your RAG pipeline.</p>
                
                <div class="decision-tree">
                    <div class="decision-node open" id="q1">
                        <div class="question">1. What is your team's OpenSearch/infrastructure expertise?</div>
                        <div class="options">
                            <button class="option-btn" onclick="selectOption('q1','low')">üü¢ Low ‚Äî We want minimal ops overhead</button>
                            <button class="option-btn" onclick="selectOption('q1','high')">üîµ High ‚Äî We can manage clusters</button>
                        </div>
                    </div>
                    <div class="decision-node" id="q2">
                        <div class="question">2. What is your expected traffic pattern?</div>
                        <div class="options">
                            <button class="option-btn" onclick="selectOption('q2','variable')">üìà Variable / Unpredictable spikes</button>
                            <button class="option-btn" onclick="selectOption('q2','steady')">üìä Steady / Predictable load</button>
                        </div>
                    </div>
                    <div class="decision-node" id="q3">
                        <div class="question">3. What is your monthly budget for the vector store?</div>
                        <div class="options">
                            <button class="option-btn" onclick="selectOption('q3','low')">üíµ Under $350/month</button>
                            <button class="option-btn" onclick="selectOption('q3','mid')">üí∞ $350 ‚Äî $1000/month</button>
                            <button class="option-btn" onclick="selectOption('q3','high')">üíé Over $1000/month</button>
                        </div>
                    </div>
                    <div class="decision-node" id="q4">
                        <div class="question">4. Do you need advanced vector tuning (FAISS, custom HNSW params)?</div>
                        <div class="options">
                            <button class="option-btn" onclick="selectOption('q4','yes')">üîß Yes ‚Äî Performance tuning is critical</button>
                            <button class="option-btn" onclick="selectOption('q4','no')">üëç No ‚Äî Default settings are fine</button>
                        </div>
                    </div>
                    <div class="decision-node" id="q5">
                        <div class="question">5. What stage is your project?</div>
                        <div class="options">
                            <button class="option-btn" onclick="selectOption('q5','poc')">üß™ POC / Prototype</button>
                            <button class="option-btn" onclick="selectOption('q5','prod')">üè≠ Production</button>
                        </div>
                    </div>
                    
                    <button onclick="getRecommendation()" style="width:100%; padding:14px; background:var(--primary); color:white; border:none; border-radius:10px; font-size:1.05em; font-weight:600; cursor:pointer; margin-top:10px;">
                        üéØ Get Recommendation
                    </button>
                    
                    <div class="result-card" id="decisionResult"></div>
                </div>
            </div>
            
            <div class="card">
                <h2>üìå Quick Decision Matrix</h2>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr><th>Scenario</th><th>Recommended</th><th>Why</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>Quick POC / Bedrock KB default</td><td><span class="pill blue">Serverless</span></td><td>Fastest setup, no infra knowledge needed</td></tr>
                            <tr><td>Budget &lt; $350/mo</td><td><span class="pill green">Managed</span></td><td>Serverless minimum exceeds this budget</td></tr>
                            <tr><td>Unpredictable query spikes</td><td><span class="pill blue">Serverless</span></td><td>Auto-scales without manual intervention</td></tr>
                            <tr><td>Large-scale prod (&gt;100M vectors)</td><td><span class="pill green">Managed</span></td><td>Cost-optimized with FAISS + RI pricing</td></tr>
                            <tr><td>Need FAISS engine</td><td><span class="pill green">Managed</span></td><td>Serverless only supports Lucene engine</td></tr>
                            <tr><td>Small team, no DevOps</td><td><span class="pill blue">Serverless</span></td><td>Zero cluster management needed</td></tr>
                            <tr><td>Regulated industry (strict security)</td><td><span class="pill green">Managed</span></td><td>More granular security configuration</td></tr>
                            <tr><td>Multi-tenant SaaS</td><td><span class="pill blue">Serverless</span></td><td>Collections isolate tenants, auto-scale</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- TAB 5: Architecture -->
        <div id="architecture" class="tab-content">
            <div class="card">
                <h2>üèóÔ∏è RAG Pipeline Architecture</h2>
                
                <h3>Ingestion Flow (Document Processing)</h3>
                <div class="arch-diagram">
                    <div class="arch-row">
                        <div class="arch-box s3">üìÅ S3 Bucket<br><span class="arch-label">Raw Documents</span></div>
                        <div class="arch-arrow">‚Üí</div>
                        <div class="arch-box app">‚ö° Lambda/ECS<br><span class="arch-label">Chunking</span></div>
                        <div class="arch-arrow">‚Üí</div>
                        <div class="arch-box embed">üß† Bedrock/SageMaker<br><span class="arch-label">Embedding Model</span></div>
                        <div class="arch-arrow">‚Üí</div>
                        <div class="arch-box os">üîç OpenSearch<br><span class="arch-label">Vector Index</span></div>
                    </div>
                </div>
                
                <h3>Query Flow (RAG Retrieval)</h3>
                <div class="arch-diagram">
                    <div class="arch-row">
                        <div class="arch-box user">üë§ User Query</div>
                        <div class="arch-arrow">‚Üí</div>
                        <div class="arch-box embed">üß† Embedding<br><span class="arch-label">Query ‚Üí Vector</span></div>
                        <div class="arch-arrow">‚Üí</div>
                        <div class="arch-box os">üîç OpenSearch<br><span class="arch-label">k-NN Search</span></div>
                        <div class="arch-arrow">‚Üí</div>
                        <div class="arch-box llm">ü§ñ LLM<br><span class="arch-label">Generate Answer</span></div>
                        <div class="arch-arrow">‚Üí</div>
                        <div class="arch-box user">üìù Response</div>
                    </div>
                </div>
            </div>
            
            <div class="compare-grid">
                <div class="card">
                    <h2>üöÄ Serverless Architecture</h2>
                    <div class="arch-diagram" style="font-size:0.85em;">
                        <p style="text-align:center; margin-bottom:14px; opacity:0.8;">Fully managed, decoupled compute</p>
                        <div class="arch-row">
                            <div class="arch-box" style="background:#ff5722;">Indexing OCUs<br><span class="arch-label">Auto-scaled</span></div>
                            <div class="arch-box" style="background:#2196f3;">Search OCUs<br><span class="arch-label">Auto-scaled</span></div>
                        </div>
                        <div style="text-align:center; opacity:0.5;">‚Üï decoupled ‚Üï</div>
                        <div class="arch-row">
                            <div class="arch-box s3" style="min-width:280px;">Amazon S3<br><span class="arch-label">Durable storage (vectors + metadata)</span></div>
                        </div>
                    </div>
                    <ul style="margin:12px 0 0 20px; font-size:0.9em;">
                        <li>Indexing and search scale independently</li>
                        <li>Multi-AZ redundancy by default</li>
                        <li>No shard/node management</li>
                        <li>S3 provides virtually unlimited storage</li>
                    </ul>
                </div>
                <div class="card">
                    <h2>‚öôÔ∏è Managed Architecture</h2>
                    <div class="arch-diagram" style="font-size:0.85em;">
                        <p style="text-align:center; margin-bottom:14px; opacity:0.8;">EC2-based, self-managed cluster</p>
                        <div class="arch-row">
                            <div class="arch-box" style="background:#ff9800;">Master<br><span class="arch-label">√ó3 nodes</span></div>
                            <div class="arch-box" style="background:#4caf50;">Data<br><span class="arch-label">√óN nodes</span></div>
                            <div class="arch-box" style="background:#9c27b0;">UltraWarm<br><span class="arch-label">optional</span></div>
                        </div>
                        <div style="text-align:center; opacity:0.5;">‚Üï EBS attached ‚Üï</div>
                        <div class="arch-row">
                            <div class="arch-box" style="background:#607d8b; min-width:280px;">EBS Volumes (gp3/io1)<br><span class="arch-label">Coupled to data nodes</span></div>
                        </div>
                    </div>
                    <ul style="margin:12px 0 0 20px; font-size:0.9em;">
                        <li>Choose instance types optimized for vectors (r6g, r5)</li>
                        <li>Tune shard count and replica settings</li>
                        <li>Configure k-NN memory circuit breakers</li>
                        <li>Add UltraWarm/Cold tiers for cost savings</li>
                    </ul>
                </div>
            </div>
            
            <div class="card">
                <h2>üß© Vector Search Engines in OpenSearch</h2>
                <div class="table-wrapper">
                    <table>
                        <thead><tr><th>Engine</th><th>Algorithm</th><th>Availability</th><th>Best For</th></tr></thead>
                        <tbody>
                            <tr><td><strong>FAISS</strong></td><td>HNSW, IVF</td><td>Managed only</td><td>High-performance, SIMD-optimized, binary quantization</td></tr>
                            <tr><td><strong>Lucene</strong></td><td>HNSW</td><td>Both</td><td>Memory-efficient, good filtering, partial index loading</td></tr>
                            <tr><td><strong>NMSLIB</strong></td><td>HNSW</td><td>Managed only (deprecated)</td><td>Legacy workloads</td></tr>
                        </tbody>
                    </table>
                </div>
                <div class="info-box info" style="margin-top:12px;">
                    <strong>üí° Lucene-on-Faiss (New)</strong>
                    OpenSearch is developing a hybrid engine that combines Lucene's memory efficiency with FAISS's SIMD-optimized distance calculations. This achieves up to 2√ó throughput improvement while enabling partial index loading ‚Äî coming soon to managed clusters.
                </div>
            </div>
        </div>

        <!-- TAB 6: References -->
        <div id="refs" class="tab-content">
            <div class="card">
                <h2>üìö Official AWS Documentation</h2>
                <ul class="ref-list">
                    <li><a href="https://docs.aws.amazon.com/opensearch-service/latest/developerguide/serverless-comparison.html" target="_blank">Comparing OpenSearch Service and OpenSearch Serverless</a><div class="ref-desc">Official AWS docs ‚Äî full feature comparison table between managed and serverless</div></li>
                    <li><a href="https://aws.amazon.com/opensearch-service/pricing/" target="_blank">Amazon OpenSearch Service Pricing</a><div class="ref-desc">Complete pricing details for both managed clusters and serverless collections</div></li>
                    <li><a href="https://aws.amazon.com/opensearch-service/features/serverless/" target="_blank">Amazon OpenSearch Serverless Features</a><div class="ref-desc">Serverless benefits, use cases, and FAQs</div></li>
                    <li><a href="https://aws.amazon.com/opensearch-service/serverless-vector-database/" target="_blank">Amazon OpenSearch as a Vector Database</a><div class="ref-desc">Vector search capabilities for RAG and generative AI applications</div></li>
                    <li><a href="https://docs.aws.amazon.com/opensearch-service/latest/developerguide/knn.html" target="_blank">k-NN Search in Amazon OpenSearch Service</a><div class="ref-desc">Official guide to k-NN plugin setup and configuration</div></li>
                </ul>
            </div>
            <div class="card">
                <h2>üìù AWS Blog Posts &amp; Guides</h2>
                <ul class="ref-list">
                    <li><a href="https://aws.amazon.com/blogs/big-data/amazon-opensearch-services-vector-database-capabilities-explained/" target="_blank">OpenSearch Service Vector Database Capabilities Explained</a><div class="ref-desc">Deep dive into vector DB capabilities, scaling, and RAG architecture</div></li>
                    <li><a href="https://aws.amazon.com/blogs/big-data/build-scalable-and-serverless-rag-workflows-with-a-vector-engine-for-amazon-opensearch-serverless/" target="_blank">Build Scalable RAG Workflows with OpenSearch Serverless</a><div class="ref-desc">End-to-end serverless RAG solution with Bedrock and OpenSearch Serverless</div></li>
                    <li><a href="https://aws.amazon.com/blogs/machine-learning/amazon-bedrock-knowledge-bases-now-supports-amazon-opensearch-service-managed-clusters-as-a-vector-store/" target="_blank">Bedrock Knowledge Bases with OpenSearch Managed Clusters</a><div class="ref-desc">Setup guide for using managed clusters as Bedrock KB vector store (July 2025)</div></li>
                    <li><a href="https://aws.amazon.com/blogs/big-data/amazon-opensearch-serverless-cost-effective-search-capabilities-at-any-scale/" target="_blank">OpenSearch Serverless: Cost-Effective Search at Any Scale</a><div class="ref-desc">Announcement of half-OCU support reducing entry costs</div></li>
                </ul>
            </div>
            <div class="card">
                <h2>üåê Community &amp; Technical Resources</h2>
                <ul class="ref-list">
                    <li><a href="https://opensearch.org/blog/using-opensearch-for-retrieval-augmented-generation-rag/" target="_blank">Using OpenSearch for RAG (opensearch.org)</a><div class="ref-desc">Community guide covering OpenSearch RAG features, plugins, and best practices</div></li>
                    <li><a href="https://caylent.com/blog/building-a-rag-with-lang-chain-on-aws" target="_blank">Building RAG with LangChain on AWS</a><div class="ref-desc">Practical tutorial using LangChain + OpenSearch Serverless for RAG</div></li>
                    <li><a href="https://opensearch.org/blog/lucene-on-faiss-powering-opensearchs-high-performance-memory-efficient-vector-search/" target="_blank">Lucene-on-Faiss: High-Performance Vector Search</a><div class="ref-desc">Technical deep-dive on the hybrid Lucene+FAISS vector engine</div></li>
                    <li><a href="https://coralogix.com/guides/opensearch/opensearch-pricing/" target="_blank">How Much Does AWS OpenSearch Really Cost?</a><div class="ref-desc">Third-party pricing analysis with real cost breakdowns</div></li>
                    <li><a href="https://cloudchipr.com/blog/aws-opensearch-pricing" target="_blank">AWS OpenSearch Pricing Explained</a><div class="ref-desc">Detailed pricing guide with worked examples</div></li>
                    <li><a href="https://last9.io/blog/opensearch-serverless/" target="_blank">OpenSearch Serverless: How It Works &amp; Key Comparisons</a><div class="ref-desc">Architecture overview and serverless vs managed comparison</div></li>
                </ul>
            </div>
        </div>
    </div>

    <footer>
        Built for RAG practitioners ¬∑ Data sourced from <a href="https://aws.amazon.com/opensearch-service/" target="_blank">AWS Documentation</a> and community resources ¬∑ Feb 2026
    </footer>

    <script>
        // Tab Navigation
        function showTab(id) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            event.target.classList.add('active');
        }

        // Cost Calculator
        function calculate() {
            const dataVol = parseFloat(document.getElementById('dataVol').value) || 50;
            const numVectors = parseFloat(document.getElementById('numVectors').value) || 5;
            const dimensions = parseInt(document.getElementById('dimensions').value);
            const queriesDay = parseInt(document.getElementById('queriesDay').value) || 1000;
            const workload = document.getElementById('workload').value;
            const env = document.getElementById('env').value;

            // Serverless calculation
            let indexOCU, searchOCU;
            if (env === 'dev') {
                indexOCU = 0.5; searchOCU = 0.5;
            } else if (env === 'staging') {
                indexOCU = 1; searchOCU = 1;
            } else {
                // production: base 2 OCU each (with standby), scale with data
                indexOCU = Math.max(2, Math.ceil(dataVol / 60));
                searchOCU = Math.max(2, Math.ceil(queriesDay / 5000) + 1);
            }
            
            const slessCompute = (indexOCU + searchOCU) * 0.24 * 730;
            const vectorStorageGB = (numVectors * 1000000 * dimensions * 4) / (1024 * 1024 * 1024);
            const slessStorage = Math.max(vectorStorageGB, dataVol) * 0.024;
            const serverlessTotal = Math.round(slessCompute + slessStorage);

            // Managed calculation
            let instanceType, instanceCost, nodeCount, ebsCost;
            if (env === 'dev') {
                instanceType = 't3.small.search';
                instanceCost = 0.036;
                nodeCount = 1;
            } else if (env === 'staging') {
                instanceType = 'r6g.large.search';
                instanceCost = 0.167;
                nodeCount = 2;
            } else {
                // production with dedicated masters
                const memNeededGB = (numVectors * 1000000 * dimensions * 4 * 1.5) / (1024 * 1024 * 1024);
                if (memNeededGB < 32) {
                    instanceType = 'r6g.large.search (16GB)';
                    instanceCost = 0.167;
                    nodeCount = Math.max(3, Math.ceil(memNeededGB / 10));
                } else if (memNeededGB < 128) {
                    instanceType = 'r6g.xlarge.search (32GB)';
                    instanceCost = 0.335;
                    nodeCount = Math.max(3, Math.ceil(memNeededGB / 20));
                } else {
                    instanceType = 'r6g.2xlarge.search (64GB)';
                    instanceCost = 0.67;
                    nodeCount = Math.max(3, Math.ceil(memNeededGB / 40));
                }
            }
            
            const managedCompute = instanceCost * nodeCount * 730;
            const masterCost = env === 'prod' ? 0.14 * 3 * 730 : 0; // 3x m5.large masters
            const ebsGB = Math.max(20, dataVol * 1.5);
            ebsCost = ebsGB * nodeCount * 0.08;
            const managedTotal = Math.round(managedCompute + masterCost + ebsCost);

            // Update UI
            document.getElementById('serverlessAmt').textContent = '$' + serverlessTotal.toLocaleString();
            document.getElementById('serverlessBreak').textContent = 
                `${indexOCU} OCU index + ${searchOCU} OCU search + ${Math.round(slessStorage)}$ storage`;
            
            document.getElementById('managedAmt').textContent = '$' + managedTotal.toLocaleString();
            document.getElementById('managedBreak').textContent = 
                `${nodeCount}√ó ${instanceType}` + (env === 'prod' ? ' + 3 masters' : '') + ` + ${Math.round(ebsGB)}GB EBS`;

            // Highlight winner
            const sBox = document.getElementById('serverlessCost');
            const mBox = document.getElementById('managedCost');
            sBox.classList.remove('winner');
            mBox.classList.remove('winner');
            
            if (serverlessTotal < managedTotal) {
                sBox.classList.add('winner');
            } else {
                mBox.classList.add('winner');
            }

            // Recommendation
            let rec = '';
            if (serverlessTotal < managedTotal * 0.8) {
                rec = 'üí° <strong>Serverless</strong> is significantly cheaper for this workload pattern.';
            } else if (managedTotal < serverlessTotal * 0.8) {
                rec = 'üí° <strong>Managed Cluster</strong> is significantly more cost-effective here.';
            } else if (workload === 'variable') {
                rec = 'üí° Costs are similar. <strong>Serverless</strong> is recommended for variable workloads (auto-scaling benefit).';
            } else {
                rec = 'üí° Costs are similar. <strong>Managed Cluster</strong> gives more control and potential RI savings.';
            }
            if (env === 'dev' && serverlessTotal > 300) {
                rec += ' Consider managed for dev/POC to save on minimum OCU costs.';
            }
            document.getElementById('recommendation').innerHTML = rec;
        }

        // Decision Guide
        const answers = {};
        function selectOption(qId, value) {
            answers[qId] = value;
            document.querySelectorAll(`#${qId} .option-btn`).forEach(b => b.classList.remove('selected'));
            event.target.classList.add('selected');
            
            // Open next question
            const questions = ['q1','q2','q3','q4','q5'];
            const idx = questions.indexOf(qId);
            if (idx < questions.length - 1) {
                document.getElementById(questions[idx + 1]).classList.add('open');
            }
        }

        function getRecommendation() {
            let serverlessScore = 0;
            let managedScore = 0;
            let reasons = [];

            if (answers.q1 === 'low') { serverlessScore += 3; reasons.push('Low ops expertise ‚Üí Serverless eliminates cluster management'); }
            if (answers.q1 === 'high') { managedScore += 2; reasons.push('High expertise ‚Üí Managed clusters unlock full tuning potential'); }
            
            if (answers.q2 === 'variable') { serverlessScore += 2; reasons.push('Variable traffic ‚Üí Serverless auto-scales seamlessly'); }
            if (answers.q2 === 'steady') { managedScore += 2; reasons.push('Steady traffic ‚Üí Managed clusters are more cost-predictable'); }
            
            if (answers.q3 === 'low') { managedScore += 3; reasons.push('Budget < $350 ‚Üí Serverless minimum exceeds this budget'); }
            if (answers.q3 === 'mid') { serverlessScore += 1; }
            if (answers.q3 === 'high') { managedScore += 1; reasons.push('High budget ‚Üí Managed with Reserved Instances maximizes value'); }
            
            if (answers.q4 === 'yes') { managedScore += 3; reasons.push('Advanced tuning needed ‚Üí Managed supports FAISS + full k-NN config'); }
            if (answers.q4 === 'no') { serverlessScore += 1; }
            
            if (answers.q5 === 'poc') { serverlessScore += 2; reasons.push('POC stage ‚Üí Serverless offers fastest time-to-value'); }
            if (answers.q5 === 'prod') { managedScore += 1; }

            const result = document.getElementById('decisionResult');
            const isServerless = serverlessScore > managedScore;
            
            result.style.display = 'block';
            result.className = 'result-card ' + (isServerless ? 'serverless-result' : 'managed-result');
            
            const choice = isServerless ? 'üöÄ OpenSearch Serverless' : '‚öôÔ∏è Managed OpenSearch Cluster';
            const score = isServerless ? serverlessScore : managedScore;
            
            result.innerHTML = `
                <h3>${choice}</h3>
                <p><strong>Confidence: ${Math.min(95, 50 + score * 8)}%</strong> (Score: Serverless ${serverlessScore} vs Managed ${managedScore})</p>
                <ul style="margin-top:12px; margin-left:18px;">
                    ${reasons.map(r => `<li style="margin:6px 0;font-size:0.93em;">${r}</li>`).join('')}
                </ul>
                <p style="margin-top:14px;font-size:0.9em;opacity:0.8;">
                    ${isServerless ? 
                        'Start with Serverless for quick iteration. Migrate to managed if costs grow or you need FAISS tuning.' : 
                        'Go with managed for cost control and performance tuning. Consider Serverless for isolated POC environments.'}
                </p>
            `;
            result.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        // Initialize calculator
        calculate();
    </script>
</body>
</html>
